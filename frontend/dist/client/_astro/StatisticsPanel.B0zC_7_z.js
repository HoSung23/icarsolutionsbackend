import{j as e}from"./jsx-runtime.IyUXLQ-P.js";import{r}from"./index.BVaoNQnN.js";import{s as i}from"./supabase.CX3PRodD.js";import"./_commonjsHelpers.gnU0ypJ3.js";const E=()=>{const[t,u]=r.useState({totalVehicles:0,availableVehicles:0,soldVehicles:0,totalQuotations:0,totalRevenue:0}),[b,n]=r.useState(!0);r.useEffect(()=>{c()},[]);const c=async()=>{n(!0);try{const{data:{user:s}}=await i.auth.getUser();if(!s)throw new Error("No autenticado");const{data:l,error:o}=await i.from("vehicles").select("id, estado");if(o)throw o;const{data:d,error:h}=await i.from("cotizaciones").select("total").eq("created_by",s.id);if(h)throw h;const x=l?.length||0,g=l?.filter(a=>a.estado==="disponible").length||0,p=l?.filter(a=>a.estado==="vendido").length||0,f=d?.length||0,v=d?.reduce((a,j)=>a+j.total,0)||0;u({totalVehicles:x,availableVehicles:g,soldVehicles:p,totalQuotations:f,totalRevenue:v})}catch(s){console.error("Error al obtener estadÃ­sticas:",s)}finally{n(!1)}};if(b)return e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsx("p",{className:"text-center text-gray-500",children:"Cargando estadÃ­sticas..."})});const m=[{label:"Total de VehÃ­culos",value:t.totalVehicles,color:"blue",icon:"ðŸš—"},{label:"Disponibles",value:t.availableVehicles,color:"green",icon:"âœ…"},{label:"Vendidos",value:t.soldVehicles,color:"red",icon:"âœ”ï¸"},{label:"Cotizaciones",value:t.totalQuotations,color:"purple",icon:"ðŸ“„"},{label:"Ingresos Totales",value:`$${t.totalRevenue.toLocaleString()}`,color:"yellow",icon:"ðŸ’°"}];return e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"EstadÃ­sticas"}),e.jsx("button",{onClick:()=>c(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-semibold transition",children:"Actualizar"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:m.map((s,l)=>{const o={blue:"bg-blue-50 border-blue-200 text-blue-900",green:"bg-green-50 border-green-200 text-green-900",red:"bg-red-50 border-red-200 text-red-900",purple:"bg-purple-50 border-purple-200 text-purple-900",yellow:"bg-yellow-50 border-yellow-200 text-yellow-900"};return e.jsxs("div",{className:`border-2 rounded-lg p-4 ${o[s.color]}`,children:[e.jsx("div",{className:"text-3xl mb-2",children:s.icon}),e.jsx("p",{className:"text-sm font-medium opacity-75",children:s.label}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:s.value})]},l)})}),e.jsxs("div",{className:"mt-8 pt-6 border-t",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Resumen del Rendimiento"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Tasa de Venta"}),e.jsxs("span",{className:"font-semibold",children:[t.totalVehicles>0?(t.soldVehicles/t.totalVehicles*100).toFixed(1):0,"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Inventario Disponible"}),e.jsx("span",{className:"font-semibold",children:t.availableVehicles})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Promedio por CotizaciÃ³n"}),e.jsxs("span",{className:"font-semibold",children:["$",t.totalQuotations>0?(t.totalRevenue/t.totalQuotations).toLocaleString():0]})]})]})]})]})};export{E as default};
