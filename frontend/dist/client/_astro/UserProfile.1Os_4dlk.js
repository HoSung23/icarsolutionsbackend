import{j as e}from"./jsx-runtime.IyUXLQ-P.js";import{r as a}from"./index.BVaoNQnN.js";import{s as n}from"./supabase.CX3PRodD.js";import"./_commonjsHelpers.gnU0ypJ3.js";const C=()=>{const[s,f]=a.useState(null),[p,c]=a.useState(!0),[m,i]=a.useState(!1),[u,l]=a.useState(""),[x,d]=a.useState(""),[o,b]=a.useState({nombre:"",email:""});a.useEffect(()=>{g()},[]);const g=async()=>{c(!0);try{const{data:{user:t}}=await n.auth.getUser();if(!t)throw new Error("No autenticado");const{data:r,error:h}=await n.from("users").select("*").eq("id",t.id).single();if(h)throw h;f(r),b({nombre:r.nombre,email:r.email})}catch(t){l(t.message)}finally{c(!1)}},y=async t=>{t.preventDefault(),l(""),d("");try{if(!s)throw new Error("Perfil no cargado");const{error:r}=await n.from("users").update({nombre:o.nombre}).eq("id",s.id);if(r)throw r;d("Perfil actualizado correctamente"),i(!1),g()}catch(r){l(r.message)}},j=async()=>{const t=prompt("Ingresa tu nueva contrase単a:");if(!t||t.length<6){l("La contrase単a debe tener al menos 6 caracteres");return}try{const{error:r}=await n.auth.updateUser({password:t});if(r)throw r;d("Contrase単a actualizada correctamente")}catch(r){l(r.message)}};return p?e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsx("p",{className:"text-center text-gray-500",children:"Cargando perfil..."})}):s?e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Mi Perfil"}),!m&&e.jsx("button",{onClick:()=>i(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-semibold transition",children:"Editar"})]}),u&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:u}),x&&e.jsx("div",{className:"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded",children:x}),m?e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre Completo"}),e.jsx("input",{type:"text",value:o.nombre,onChange:t=>b({...o,nombre:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email (No editable)"}),e.jsx("input",{type:"email",value:o.email,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-600"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg font-semibold transition",children:"Guardar Cambios"}),e.jsx("button",{type:"button",onClick:()=>i(!1),className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-900 py-2 rounded-lg font-semibold transition",children:"Cancelar"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Nombre"}),e.jsx("p",{className:"text-lg text-gray-900 mt-1",children:s.nombre})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Email"}),e.jsx("p",{className:"text-lg text-gray-900 mt-1",children:s.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Rol"}),e.jsx("p",{className:"text-lg text-gray-900 mt-1 capitalize",children:s.rol})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Seguridad"}),e.jsx("button",{onClick:j,className:"bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg font-semibold transition",children:"Cambiar Contrase単a"})]})]})]}):e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsx("p",{className:"text-center text-red-500",children:"Error al cargar el perfil"})})};export{C as default};
